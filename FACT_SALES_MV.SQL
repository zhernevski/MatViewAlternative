CREATE MATERIALIZED VIEW "FACT_SALES_MV" ("PROD_ID", "CUST_ID", "TIME_ID", "CHANNEL_ID", "PROMO_ID", "QUANTITY_SOLD", "AMOUNT_SOLD", "CUST_FIRST_NAME", "CUST_LAST_NAME", "CUST_NAME", "COUNTRY_NAME", "UNIT_COST", "UNIT_PRICE", "CHANNEL_DESC", "PROMO_NAME", "PROD_NAME", "PROD_CATEGORY", "PROD_SUBCATEGORY")
  DEFAULT COLLATION "USING_NLS_COMP"  SEGMENT CREATION IMMEDIATE
  ORGANIZATION HEAP PCTFREE 10 PCTUSED 40 INITRANS 10 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "DATA" 
  BUILD IMMEDIATE
  USING INDEX 
  REFRESH FORCE ON DEMAND
  USING DEFAULT LOCAL ROLLBACK SEGMENT
  USING ENFORCED CONSTRAINTS DISABLE ON QUERY COMPUTATION DISABLE QUERY REWRITE
  AS SELECT
SALES.PROD_ID,
SALES.CUST_ID,
SALES.TIME_ID,
SALES.CHANNEL_ID,
SALES.PROMO_ID,
SALES.QUANTITY_SOLD,
SALES.AMOUNT_SOLD,
CUSTOMERS.CUST_FIRST_NAME,
CUSTOMERS.CUST_LAST_NAME,
CUSTOMERS.CUST_FIRST_NAME||CUSTOMERS.CUST_LAST_NAME CUST_NAME,
COUNTRIES.COUNTRY_NAME,
COSTS.UNIT_COST,
COSTS.UNIT_PRICE,
CHANNELS.CHANNEL_DESC,
PROMOTIONS.PROMO_NAME,
PRODUCTS.PROD_NAME,
PRODUCTS.PROD_CATEGORY,
PRODUCTS.PROD_SUBCATEGORY
FROM SALES
LEFT JOIN COSTS ON SALES.PROD_ID=COSTS.PROD_ID AND SALES.TIME_ID=COSTS.TIME_ID AND SALES.PROMO_ID=COSTS.PROMO_ID AND SALES.CHANNEL_ID=COSTS.CHANNEL_ID
LEFT JOIN CHANNELS ON CHANNELS.CHANNEL_ID=SALES.CHANNEL_ID
LEFT JOIN PROMOTIONS ON PROMOTIONS.PROMO_ID=SALES.PROMO_ID
LEFT JOIN CUSTOMERS ON CUSTOMERS.CUST_ID=SALES.CUST_ID
LEFT JOIN COUNTRIES ON COUNTRIES.COUNTRY_ID=CUSTOMERS.COUNTRY_ID
LEFT JOIN PRODUCTS ON PRODUCTS.PROD_ID=SALES.PROD_ID
LEFT JOIN TIMES ON TIMES.TIME_ID=SALES.TIME_ID;
