DROP TABLE SALES;
DROP TABLE COSTS;
DROP TABLE PROMOTIONS;
DROP TABLE CUSTOMERS;
DROP TABLE COUNTRIES;
DROP TABLE PRODUCTS;
DROP TABLE TIMES;
DROP TABLE CHANNELS;

--------------------------------------------------------
--  DDL for Table CHANNELS
--------------------------------------------------------

  CREATE TABLE "CHANNELS" 
   (	"CHANNEL_ID" NUMBER, 
	"CHANNEL_DESC" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"CHANNEL_CLASS" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"CHANNEL_CLASS_ID" NUMBER, 
	"CHANNEL_TOTAL" VARCHAR2(13 BYTE) COLLATE "USING_NLS_COMP", 
	"CHANNEL_TOTAL_ID" NUMBER
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "CHANNELS"."CHANNEL_ID" IS 'primary key column';
   COMMENT ON COLUMN "CHANNELS"."CHANNEL_DESC" IS 'e.g. telesales, internet, catalog';
   COMMENT ON COLUMN "CHANNELS"."CHANNEL_CLASS" IS 'e.g. direct, indirect';
   COMMENT ON TABLE "CHANNELS"  IS 'small dimension table';
  GRANT READ ON "CHANNELS" TO PUBLIC;
  GRANT READ ON "CHANNELS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table COSTS
--------------------------------------------------------

  CREATE TABLE "COSTS" 
   (	"PROD_ID" NUMBER, 
	"TIME_ID" DATE, 
	"PROMO_ID" NUMBER, 
	"CHANNEL_ID" NUMBER, 
	"UNIT_COST" NUMBER(10,2), 
	"UNIT_PRICE" NUMBER(10,2)
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;
  GRANT READ ON "COSTS" TO PUBLIC;
  GRANT READ ON "COSTS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table COUNTRIES
--------------------------------------------------------

  CREATE TABLE "COUNTRIES" 
   (	"COUNTRY_ID" NUMBER, 
	"COUNTRY_ISO_CODE" CHAR(2 BYTE) COLLATE "USING_NLS_COMP", 
	"COUNTRY_NAME" VARCHAR2(40 BYTE) COLLATE "USING_NLS_COMP", 
	"COUNTRY_SUBREGION" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"COUNTRY_SUBREGION_ID" NUMBER, 
	"COUNTRY_REGION" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"COUNTRY_REGION_ID" NUMBER, 
	"COUNTRY_TOTAL" VARCHAR2(11 BYTE) COLLATE "USING_NLS_COMP", 
	"COUNTRY_TOTAL_ID" NUMBER, 
	"COUNTRY_NAME_HIST" VARCHAR2(40 BYTE) COLLATE "USING_NLS_COMP"
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "COUNTRIES"."COUNTRY_ID" IS 'primary key';
   COMMENT ON COLUMN "COUNTRIES"."COUNTRY_NAME" IS 'country name';
   COMMENT ON COLUMN "COUNTRIES"."COUNTRY_SUBREGION" IS 'e.g. Western Europe, to allow hierarchies';
   COMMENT ON COLUMN "COUNTRIES"."COUNTRY_REGION" IS 'e.g. Europe, Asia';
   COMMENT ON TABLE "COUNTRIES"  IS 'country dimension table (snowflake)';
  GRANT READ ON "COUNTRIES" TO PUBLIC;
  GRANT READ ON "COUNTRIES" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table CUSTOMERS
--------------------------------------------------------

  CREATE TABLE "CUSTOMERS" 
   (	"CUST_ID" NUMBER, 
	"CUST_FIRST_NAME" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_LAST_NAME" VARCHAR2(40 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_GENDER" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_YEAR_OF_BIRTH" NUMBER(4,0), 
	"CUST_MARITAL_STATUS" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_STREET_ADDRESS" VARCHAR2(40 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_POSTAL_CODE" VARCHAR2(10 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_CITY" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_CITY_ID" NUMBER, 
	"CUST_STATE_PROVINCE" VARCHAR2(40 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_STATE_PROVINCE_ID" NUMBER, 
	"COUNTRY_ID" NUMBER, 
	"CUST_MAIN_PHONE_NUMBER" VARCHAR2(25 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_INCOME_LEVEL" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_CREDIT_LIMIT" NUMBER, 
	"CUST_EMAIL" VARCHAR2(50 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_TOTAL" VARCHAR2(14 BYTE) COLLATE "USING_NLS_COMP", 
	"CUST_TOTAL_ID" NUMBER, 
	"CUST_SRC_ID" NUMBER, 
	"CUST_EFF_FROM" DATE, 
	"CUST_EFF_TO" DATE, 
	"CUST_VALID" VARCHAR2(1 BYTE) COLLATE "USING_NLS_COMP"
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "CUSTOMERS"."CUST_ID" IS 'primary key';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_FIRST_NAME" IS 'first name of the customer';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_LAST_NAME" IS 'last name of the customer';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_GENDER" IS 'gender; low cardinality attribute';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_YEAR_OF_BIRTH" IS 'customer year of birth';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_MARITAL_STATUS" IS 'customer marital status; low cardinality attribute';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_STREET_ADDRESS" IS 'customer street address';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_POSTAL_CODE" IS 'postal code of the customer';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_CITY" IS 'city where the customer lives';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_STATE_PROVINCE" IS 'customer geography: state or province';
   COMMENT ON COLUMN "CUSTOMERS"."COUNTRY_ID" IS 'foreign key to the countries table (snowflake)';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_MAIN_PHONE_NUMBER" IS 'customer main phone number';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_INCOME_LEVEL" IS 'customer income level';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_CREDIT_LIMIT" IS 'customer credit limit';
   COMMENT ON COLUMN "CUSTOMERS"."CUST_EMAIL" IS 'customer email id';
   COMMENT ON TABLE "CUSTOMERS"  IS 'dimension table';
  GRANT READ ON "CUSTOMERS" TO PUBLIC;
  GRANT READ ON "CUSTOMERS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table PRODUCTS
--------------------------------------------------------

  CREATE TABLE "PRODUCTS" 
   (	"PROD_ID" NUMBER(6,0), 
	"PROD_NAME" VARCHAR2(50 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_DESC" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_SUBCATEGORY" VARCHAR2(50 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_SUBCATEGORY_ID" NUMBER, 
	"PROD_SUBCATEGORY_DESC" VARCHAR2(2000 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_CATEGORY" VARCHAR2(50 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_CATEGORY_ID" NUMBER, 
	"PROD_CATEGORY_DESC" VARCHAR2(2000 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_WEIGHT_CLASS" NUMBER(3,0), 
	"PROD_UNIT_OF_MEASURE" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_PACK_SIZE" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"SUPPLIER_ID" NUMBER(6,0), 
	"PROD_STATUS" VARCHAR2(20 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_LIST_PRICE" NUMBER(8,2), 
	"PROD_MIN_PRICE" NUMBER(8,2), 
	"PROD_TOTAL" VARCHAR2(13 BYTE) COLLATE "USING_NLS_COMP", 
	"PROD_TOTAL_ID" NUMBER, 
	"PROD_SRC_ID" NUMBER, 
	"PROD_EFF_FROM" DATE, 
	"PROD_EFF_TO" DATE, 
	"PROD_VALID" VARCHAR2(1 BYTE) COLLATE "USING_NLS_COMP"
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "PRODUCTS"."PROD_ID" IS 'primary key';
   COMMENT ON COLUMN "PRODUCTS"."PROD_NAME" IS 'product name';
   COMMENT ON COLUMN "PRODUCTS"."PROD_DESC" IS 'product description';
   COMMENT ON COLUMN "PRODUCTS"."PROD_SUBCATEGORY" IS 'product subcategory';
   COMMENT ON COLUMN "PRODUCTS"."PROD_SUBCATEGORY_DESC" IS 'product subcategory description';
   COMMENT ON COLUMN "PRODUCTS"."PROD_CATEGORY" IS 'product category';
   COMMENT ON COLUMN "PRODUCTS"."PROD_CATEGORY_DESC" IS 'product category description';
   COMMENT ON COLUMN "PRODUCTS"."PROD_WEIGHT_CLASS" IS 'product weight class';
   COMMENT ON COLUMN "PRODUCTS"."PROD_UNIT_OF_MEASURE" IS 'product unit of measure';
   COMMENT ON COLUMN "PRODUCTS"."PROD_PACK_SIZE" IS 'product package size';
   COMMENT ON COLUMN "PRODUCTS"."SUPPLIER_ID" IS 'this column';
   COMMENT ON COLUMN "PRODUCTS"."PROD_STATUS" IS 'product status';
   COMMENT ON COLUMN "PRODUCTS"."PROD_LIST_PRICE" IS 'product list price';
   COMMENT ON COLUMN "PRODUCTS"."PROD_MIN_PRICE" IS 'product minimum price';
   COMMENT ON TABLE "PRODUCTS"  IS 'dimension table';
  GRANT READ ON "PRODUCTS" TO PUBLIC;
  GRANT READ ON "PRODUCTS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table PROMOTIONS
--------------------------------------------------------

  CREATE TABLE "PROMOTIONS" 
   (	"PROMO_ID" NUMBER(6,0), 
	"PROMO_NAME" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"PROMO_SUBCATEGORY" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"PROMO_SUBCATEGORY_ID" NUMBER, 
	"PROMO_CATEGORY" VARCHAR2(30 BYTE) COLLATE "USING_NLS_COMP", 
	"PROMO_CATEGORY_ID" NUMBER, 
	"PROMO_COST" NUMBER(10,2), 
	"PROMO_BEGIN_DATE" DATE, 
	"PROMO_END_DATE" DATE, 
	"PROMO_TOTAL" VARCHAR2(15 BYTE) COLLATE "USING_NLS_COMP", 
	"PROMO_TOTAL_ID" NUMBER
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "PROMOTIONS"."PROMO_ID" IS 'primary key column';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_NAME" IS 'promotion description';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_SUBCATEGORY" IS 'enables to investigate promotion hierarchies';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_CATEGORY" IS 'promotion category';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_COST" IS 'promotion cost, to do promotion effect calculations';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_BEGIN_DATE" IS 'promotion begin day';
   COMMENT ON COLUMN "PROMOTIONS"."PROMO_END_DATE" IS 'promotion end day';
   COMMENT ON TABLE "PROMOTIONS"  IS 'dimension table without a PK-FK relationship with the facts table, to show outer join functionality';
  GRANT READ ON "PROMOTIONS" TO PUBLIC;
  GRANT READ ON "PROMOTIONS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table SALES
--------------------------------------------------------

  CREATE TABLE "SALES" 
   (	"PROD_ID" NUMBER, 
	"CUST_ID" NUMBER, 
	"TIME_ID" DATE, 
	"CHANNEL_ID" NUMBER, 
	"PROMO_ID" NUMBER, 
	"QUANTITY_SOLD" NUMBER(10,2), 
	"AMOUNT_SOLD" NUMBER(10,2)
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "SALES"."PROD_ID" IS 'FK to the products dimension table';
   COMMENT ON COLUMN "SALES"."CUST_ID" IS 'FK to the customers dimension table';
   COMMENT ON COLUMN "SALES"."TIME_ID" IS 'FK to the times dimension table';
   COMMENT ON COLUMN "SALES"."CHANNEL_ID" IS 'FK to the channels dimension table';
   COMMENT ON COLUMN "SALES"."PROMO_ID" IS 'promotion identifier, without FK constraint (intentionally) to show outer join optimization';
   COMMENT ON COLUMN "SALES"."QUANTITY_SOLD" IS 'product quantity sold with the transaction';
   COMMENT ON COLUMN "SALES"."AMOUNT_SOLD" IS 'invoiced amount to the customer';
   COMMENT ON TABLE "SALES"  IS 'facts table, without a primary key; all rows are uniquely identified by the combination of all foreign keys';
  GRANT READ ON "SALES" TO PUBLIC;
  GRANT READ ON "SALES" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table SUPPLEMENTARY_DEMOGRAPHICS
--------------------------------------------------------

  CREATE TABLE "SUPPLEMENTARY_DEMOGRAPHICS" 
   (	"CUST_ID" NUMBER, 
	"EDUCATION" VARCHAR2(21 BYTE) COLLATE "USING_NLS_COMP", 
	"OCCUPATION" VARCHAR2(21 BYTE) COLLATE "USING_NLS_COMP", 
	"HOUSEHOLD_SIZE" VARCHAR2(21 BYTE) COLLATE "USING_NLS_COMP", 
	"YRS_RESIDENCE" NUMBER, 
	"AFFINITY_CARD" NUMBER(10,0), 
	"BULK_PACK_DISKETTES" NUMBER(10,0), 
	"FLAT_PANEL_MONITOR" NUMBER(10,0), 
	"HOME_THEATER_PACKAGE" NUMBER(10,0), 
	"BOOKKEEPING_APPLICATION" NUMBER(10,0), 
	"PRINTER_SUPPLIES" NUMBER(10,0), 
	"Y_BOX_GAMES" NUMBER(10,0), 
	"OS_DOC_SET_KANJI" NUMBER(10,0), 
	"COMMENTS" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP"
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;
  GRANT READ ON "SUPPLEMENTARY_DEMOGRAPHICS" TO PUBLIC;
  GRANT READ ON "SUPPLEMENTARY_DEMOGRAPHICS" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  DDL for Table TIMES
--------------------------------------------------------

  CREATE TABLE "TIMES" 
   (	"TIME_ID" DATE, 
	"DAY_NAME" VARCHAR2(9 BYTE) COLLATE "USING_NLS_COMP", 
	"DAY_NUMBER_IN_WEEK" NUMBER(1,0), 
	"DAY_NUMBER_IN_MONTH" NUMBER(2,0), 
	"CALENDAR_WEEK_NUMBER" NUMBER(2,0), 
	"FISCAL_WEEK_NUMBER" NUMBER(2,0), 
	"WEEK_ENDING_DAY" DATE, 
	"WEEK_ENDING_DAY_ID" NUMBER, 
	"CALENDAR_MONTH_NUMBER" NUMBER(2,0), 
	"FISCAL_MONTH_NUMBER" NUMBER(2,0), 
	"CALENDAR_MONTH_DESC" VARCHAR2(8 BYTE) COLLATE "USING_NLS_COMP", 
	"CALENDAR_MONTH_ID" NUMBER, 
	"FISCAL_MONTH_DESC" VARCHAR2(8 BYTE) COLLATE "USING_NLS_COMP", 
	"FISCAL_MONTH_ID" NUMBER, 
	"DAYS_IN_CAL_MONTH" NUMBER, 
	"DAYS_IN_FIS_MONTH" NUMBER, 
	"END_OF_CAL_MONTH" DATE, 
	"END_OF_FIS_MONTH" DATE, 
	"CALENDAR_MONTH_NAME" VARCHAR2(9 BYTE) COLLATE "USING_NLS_COMP", 
	"FISCAL_MONTH_NAME" VARCHAR2(9 BYTE) COLLATE "USING_NLS_COMP", 
	"CALENDAR_QUARTER_DESC" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"CALENDAR_QUARTER_ID" NUMBER, 
	"FISCAL_QUARTER_DESC" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"FISCAL_QUARTER_ID" NUMBER, 
	"DAYS_IN_CAL_QUARTER" NUMBER, 
	"DAYS_IN_FIS_QUARTER" NUMBER, 
	"END_OF_CAL_QUARTER" DATE, 
	"END_OF_FIS_QUARTER" DATE, 
	"CALENDAR_QUARTER_NUMBER" NUMBER(1,0), 
	"FISCAL_QUARTER_NUMBER" NUMBER(1,0), 
	"CALENDAR_YEAR" NUMBER(4,0), 
	"CALENDAR_YEAR_ID" NUMBER, 
	"FISCAL_YEAR" NUMBER(4,0), 
	"FISCAL_YEAR_ID" NUMBER, 
	"DAYS_IN_CAL_YEAR" NUMBER, 
	"DAYS_IN_FIS_YEAR" NUMBER, 
	"END_OF_CAL_YEAR" DATE, 
	"END_OF_FIS_YEAR" DATE
   )  DEFAULT COLLATION "USING_NLS_COMP" SEGMENT CREATION IMMEDIATE 
  PCTFREE 0 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 COLUMN STORE COMPRESS FOR QUERY HIGH NO ROW LEVEL LOCKING LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SAMPLESCHEMA" ;

   COMMENT ON COLUMN "TIMES"."TIME_ID" IS 'primary key; day date, finest granularity, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."DAY_NAME" IS 'Monday to Sunday, repeating';
   COMMENT ON COLUMN "TIMES"."DAY_NUMBER_IN_WEEK" IS '1 to 7, repeating';
   COMMENT ON COLUMN "TIMES"."DAY_NUMBER_IN_MONTH" IS '1 to 31, repeating';
   COMMENT ON COLUMN "TIMES"."CALENDAR_WEEK_NUMBER" IS '1 to 53, repeating';
   COMMENT ON COLUMN "TIMES"."FISCAL_WEEK_NUMBER" IS '1 to 53, repeating';
   COMMENT ON COLUMN "TIMES"."WEEK_ENDING_DAY" IS 'date of last day in week, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."CALENDAR_MONTH_NUMBER" IS '1 to 12, repeating';
   COMMENT ON COLUMN "TIMES"."FISCAL_MONTH_NUMBER" IS '1 to 12, repeating';
   COMMENT ON COLUMN "TIMES"."CALENDAR_MONTH_DESC" IS 'e.g. 1998-01, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."FISCAL_MONTH_DESC" IS 'e.g. 1998-01, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_CAL_MONTH" IS 'e.g. 28,31, repeating';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_FIS_MONTH" IS 'e.g. 25,32, repeating';
   COMMENT ON COLUMN "TIMES"."END_OF_CAL_MONTH" IS 'last day of calendar month';
   COMMENT ON COLUMN "TIMES"."END_OF_FIS_MONTH" IS 'last day of fiscal month';
   COMMENT ON COLUMN "TIMES"."CALENDAR_MONTH_NAME" IS 'January to December, repeating';
   COMMENT ON COLUMN "TIMES"."FISCAL_MONTH_NAME" IS 'January to December, repeating';
   COMMENT ON COLUMN "TIMES"."CALENDAR_QUARTER_DESC" IS 'e.g. 1998-Q1, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."FISCAL_QUARTER_DESC" IS 'e.g. 1999-Q3, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_CAL_QUARTER" IS 'e.g. 88,90, repeating';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_FIS_QUARTER" IS 'e.g. 88,90, repeating';
   COMMENT ON COLUMN "TIMES"."END_OF_CAL_QUARTER" IS 'last day of calendar quarter';
   COMMENT ON COLUMN "TIMES"."END_OF_FIS_QUARTER" IS 'last day of fiscal quarter';
   COMMENT ON COLUMN "TIMES"."CALENDAR_QUARTER_NUMBER" IS '1 to 4, repeating';
   COMMENT ON COLUMN "TIMES"."FISCAL_QUARTER_NUMBER" IS '1 to 4, repeating';
   COMMENT ON COLUMN "TIMES"."CALENDAR_YEAR" IS 'e.g. 1999, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."FISCAL_YEAR" IS 'e.g. 1999, CORRECT ORDER';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_CAL_YEAR" IS '365,366 repeating';
   COMMENT ON COLUMN "TIMES"."DAYS_IN_FIS_YEAR" IS 'e.g. 355,364, repeating';
   COMMENT ON COLUMN "TIMES"."END_OF_CAL_YEAR" IS 'last day of cal year';
   COMMENT ON COLUMN "TIMES"."END_OF_FIS_YEAR" IS 'last day of fiscal year';
   COMMENT ON TABLE "TIMES"  IS 'Time dimension table to support multiple hierarchies and materialized views';
  GRANT READ ON "TIMES" TO PUBLIC;
  GRANT READ ON "TIMES" TO "ADMIN" WITH GRANT OPTION;
--------------------------------------------------------
--  Constraints for Table CHANNELS
--------------------------------------------------------

  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_ID" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_DESC" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_CLASS" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_CLASS_ID" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_TOTAL" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" MODIFY ("CHANNEL_TOTAL_ID" NOT NULL ENABLE);
  ALTER TABLE "CHANNELS" ADD CONSTRAINT "CHANNELS_PK" PRIMARY KEY ("CHANNEL_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table COSTS
--------------------------------------------------------

  ALTER TABLE "COSTS" MODIFY ("PROD_ID" NOT NULL ENABLE);
  ALTER TABLE "COSTS" MODIFY ("TIME_ID" NOT NULL ENABLE);
  ALTER TABLE "COSTS" MODIFY ("PROMO_ID" NOT NULL ENABLE);
  ALTER TABLE "COSTS" MODIFY ("CHANNEL_ID" NOT NULL ENABLE);
  ALTER TABLE "COSTS" MODIFY ("UNIT_COST" NOT NULL ENABLE);
  ALTER TABLE "COSTS" MODIFY ("UNIT_PRICE" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table COUNTRIES
--------------------------------------------------------

  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_ID" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_ISO_CODE" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_NAME" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_SUBREGION" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_SUBREGION_ID" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_REGION" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_REGION_ID" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_TOTAL" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" MODIFY ("COUNTRY_TOTAL_ID" NOT NULL ENABLE);
  ALTER TABLE "COUNTRIES" ADD CONSTRAINT "COUNTRIES_PK" PRIMARY KEY ("COUNTRY_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table CUSTOMERS
--------------------------------------------------------

  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_ID" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_FIRST_NAME" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_LAST_NAME" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_GENDER" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_YEAR_OF_BIRTH" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_STREET_ADDRESS" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_POSTAL_CODE" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_CITY" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_CITY_ID" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_STATE_PROVINCE" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_STATE_PROVINCE_ID" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("COUNTRY_ID" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_MAIN_PHONE_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_TOTAL" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" MODIFY ("CUST_TOTAL_ID" NOT NULL ENABLE);
  ALTER TABLE "CUSTOMERS" ADD CONSTRAINT "CUSTOMERS_PK" PRIMARY KEY ("CUST_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table PRODUCTS
--------------------------------------------------------

  ALTER TABLE "PRODUCTS" MODIFY ("PROD_ID" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_NAME" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_DESC" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_SUBCATEGORY" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_SUBCATEGORY_ID" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_SUBCATEGORY_DESC" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_CATEGORY" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_CATEGORY_ID" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_CATEGORY_DESC" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_WEIGHT_CLASS" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_PACK_SIZE" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("SUPPLIER_ID" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_STATUS" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_LIST_PRICE" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_MIN_PRICE" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_TOTAL" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" MODIFY ("PROD_TOTAL_ID" NOT NULL ENABLE);
  ALTER TABLE "PRODUCTS" ADD CONSTRAINT "PRODUCTS_PK" PRIMARY KEY ("PROD_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table PROMOTIONS
--------------------------------------------------------

  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_ID" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_NAME" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_SUBCATEGORY" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_SUBCATEGORY_ID" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_CATEGORY" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_CATEGORY_ID" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_COST" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_BEGIN_DATE" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_END_DATE" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_TOTAL" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" MODIFY ("PROMO_TOTAL_ID" NOT NULL ENABLE);
  ALTER TABLE "PROMOTIONS" ADD CONSTRAINT "PROMO_PK" PRIMARY KEY ("PROMO_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table SALES
--------------------------------------------------------

  ALTER TABLE "SALES" MODIFY ("PROD_ID" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("CUST_ID" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("TIME_ID" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("CHANNEL_ID" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("PROMO_ID" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("QUANTITY_SOLD" NOT NULL ENABLE);
  ALTER TABLE "SALES" MODIFY ("AMOUNT_SOLD" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table SUPPLEMENTARY_DEMOGRAPHICS
--------------------------------------------------------

  ALTER TABLE "SUPPLEMENTARY_DEMOGRAPHICS" MODIFY ("CUST_ID" NOT NULL ENABLE);
  ALTER TABLE "SUPPLEMENTARY_DEMOGRAPHICS" ADD CONSTRAINT "SUPP_DEMO_PK" PRIMARY KEY ("CUST_ID") RELY DISABLE;
--------------------------------------------------------
--  Constraints for Table TIMES
--------------------------------------------------------

  ALTER TABLE "TIMES" MODIFY ("TIME_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAY_NAME" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAY_NUMBER_IN_WEEK" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAY_NUMBER_IN_MONTH" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_WEEK_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_WEEK_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("WEEK_ENDING_DAY" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("WEEK_ENDING_DAY_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_MONTH_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_MONTH_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_MONTH_DESC" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_MONTH_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_MONTH_DESC" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_MONTH_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_CAL_MONTH" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_FIS_MONTH" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_CAL_MONTH" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_FIS_MONTH" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_MONTH_NAME" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_MONTH_NAME" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_QUARTER_DESC" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_QUARTER_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_QUARTER_DESC" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_QUARTER_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_CAL_QUARTER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_FIS_QUARTER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_CAL_QUARTER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_FIS_QUARTER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_QUARTER_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_QUARTER_NUMBER" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("CALENDAR_YEAR_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("FISCAL_YEAR_ID" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_CAL_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("DAYS_IN_FIS_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_CAL_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" MODIFY ("END_OF_FIS_YEAR" NOT NULL ENABLE);
  ALTER TABLE "TIMES" ADD CONSTRAINT "TIMES_PK" PRIMARY KEY ("TIME_ID") RELY DISABLE;
--------------------------------------------------------
--  Ref Constraints for Table COSTS
--------------------------------------------------------

  ALTER TABLE "COSTS" ADD CONSTRAINT "COSTS_PROMO_FK" FOREIGN KEY ("PROMO_ID")
	  REFERENCES "PROMOTIONS" ("PROMO_ID") RELY DISABLE;
  ALTER TABLE "COSTS" ADD CONSTRAINT "COSTS_CHANNEL_FK" FOREIGN KEY ("CHANNEL_ID")
	  REFERENCES "CHANNELS" ("CHANNEL_ID") RELY DISABLE;
  ALTER TABLE "COSTS" ADD CONSTRAINT "COSTS_PRODUCT_FK" FOREIGN KEY ("PROD_ID")
	  REFERENCES "PRODUCTS" ("PROD_ID") RELY DISABLE;
  ALTER TABLE "COSTS" ADD CONSTRAINT "COSTS_TIME_FK" FOREIGN KEY ("TIME_ID")
	  REFERENCES "TIMES" ("TIME_ID") RELY DISABLE;
--------------------------------------------------------
--  Ref Constraints for Table CUSTOMERS
--------------------------------------------------------

  ALTER TABLE "CUSTOMERS" ADD CONSTRAINT "CUSTOMERS_COUNTRY_FK" FOREIGN KEY ("COUNTRY_ID")
	  REFERENCES "COUNTRIES" ("COUNTRY_ID") RELY DISABLE;
--------------------------------------------------------
--  Ref Constraints for Table SALES
--------------------------------------------------------

  ALTER TABLE "SALES" ADD CONSTRAINT "SALES_PROMO_FK" FOREIGN KEY ("PROMO_ID")
	  REFERENCES "PROMOTIONS" ("PROMO_ID") RELY DISABLE;
  ALTER TABLE "SALES" ADD CONSTRAINT "SALES_PRODUCT_FK" FOREIGN KEY ("PROD_ID")
	  REFERENCES "PRODUCTS" ("PROD_ID") RELY DISABLE;
  ALTER TABLE "SALES" ADD CONSTRAINT "SALES_CUSTOMER_FK" FOREIGN KEY ("CUST_ID")
	  REFERENCES "CUSTOMERS" ("CUST_ID") RELY DISABLE;
  ALTER TABLE "SALES" ADD CONSTRAINT "SALES_CHANNEL_FK" FOREIGN KEY ("CHANNEL_ID")
	  REFERENCES "CHANNELS" ("CHANNEL_ID") RELY DISABLE;
  ALTER TABLE "SALES" ADD CONSTRAINT "SALES_TIME_FK" FOREIGN KEY ("TIME_ID")
	  REFERENCES "TIMES" ("TIME_ID") RELY DISABLE;


INSERT INTO SALES SELECT * from SH.SALES ;
INSERT INTO COSTS SELECT * FROM SH.COSTS;
INSERT INTO PROMOTIONS SELECT * FROM SH.PROMOTIONS;
INSERT INTO CUSTOMERS SELECT * FROM SH.CUSTOMERS;
INSERT INTO COUNTRIES SELECT * FROM SH.COUNTRIES;
INSERT INTO PRODUCTS SELECT * FROM SH.PRODUCTS;
INSERT INTO TIMES SELECT * FROM SH.TIMES;
INSERT INTO CHANNELS SELECT * FROM SH.CHANNELS;
